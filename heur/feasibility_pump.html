

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Feasibility Pump &mdash; HIPS 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/toggleprompt.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Two Stage Feasibility Pump" href="2stage_fp.html" />
    <link rel="prev" title="Diving Heuristics" href="abstract_diving.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> HIPS
          

          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation and Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../heuristics.html">Heuristics</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="simple_rounding.html">Simple Rounding</a></li>
<li class="toctree-l2"><a class="reference internal" href="bounds.html">Bounds Heuristic</a></li>
<li class="toctree-l2"><a class="reference internal" href="rens.html">RENS</a></li>
<li class="toctree-l2"><a class="reference internal" href="abstract_diving.html">Diving Heuristics</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Feasibility Pump</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#example-1">Example 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-2">Example 2</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="2stage_fp.html">Two Stage Feasibility Pump</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_api.html">Developer API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">HIPS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../heuristics.html">Heuristics</a> &raquo;</li>
        
      <li>Feasibility Pump</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/heur/feasibility_pump.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="feasibility-pump">
<h1>Feasibility Pump<a class="headerlink" href="#feasibility-pump" title="Permalink to this headline">¶</a></h1>
<p>The <strong>Feasibility Pump</strong>, proposed in 2005 by Fischetti et al. <span id="id1">[<a class="reference internal" href="../references.html#id4" title="Matteo Fischetti, Fred Glover, and Andrea Lodi. The feasibility pump. Mathematical Programming, 104(1):91-104, Sep 2005. URL: https://doi.org/10.1007/s10107-004-0570-3, doi:10.1007/s10107-004-0570-3.">FGL05</a>]</span>, aims to compute
a feasible solution to an MIP without the need for an initial solution. The heuristic is an integral part of HIPS
and has significantly influenced and inspired the implementation of this library. The heuristic is also described in <span id="id2">[<a class="reference internal" href="../references.html#id2" title="Timo Berthold. Primal heuristics for mixed integer programs. Master's thesis, Technische Universität Berlin, 2006. URL: https://opus4.kobv.de/opus4-zib/files/1029/Berthold_Primal_Heuristics_For_Mixed_Integer_Programs.pdf.">Ber06</a>]</span>.</p>
<p>Assume we have the following general MIP:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{lr&#64;{}l&#64;{}l&#64;{}l}
\text{minimize }   &amp; c^T x  \\
\text{subject to } &amp; Ax \le b \\
                    &amp; x_j \in \mathbb{Z}\text{, } \forall j \in I
\end{array}\end{split}\]</div>
<p>We define the rounding <span class="math notranslate nohighlight">\(\tilde{x}\)</span> of a variable <span class="math notranslate nohighlight">\(x\)</span> as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\tilde{x}_j = \begin{cases} [x_j], &amp; j \in I\\ x_j, &amp; \text{otherwise} \end{cases}\end{split}\]</div>
<p>Note that <span class="math notranslate nohighlight">\([ \cdot ]\)</span> denotes the rounding to nearest integer. Then, we search the point <span class="math notranslate nohighlight">\({x\text{*}}\)</span>, the solution to the following LP:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{lr&#64;{}l&#64;{}l&#64;{}l}
\text{minimize }   &amp; \Delta (x, \tilde{x})  \\
\text{subject to } &amp; Ax \le b,
\end{array}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta\)</span> is defined as the <span class="math notranslate nohighlight">\(L_1\)</span>-Norm:</p>
<div class="math notranslate nohighlight">
\[\Delta(x, \tilde{x}) = \sum_{j \in I} | x_j - \tilde{x}_j |\]</div>
<p>With the terminology introduced, we can now generate two sequences which are the core of the <strong>Feasibility Pump</strong>.
We iteratively compute LP feasible points <span class="math notranslate nohighlight">\(\bar{x}\)</span> and round it to the respective integer feasible points
<span class="math notranslate nohighlight">\(\tilde{x}\)</span>. Subsequent points <span class="math notranslate nohighlight">\(\bar{x}\)</span> are computed by finding the LP feasible point <span class="math notranslate nohighlight">\({x\text{*}}\)</span> (computed as above)
, which minimizes the distance from <span class="math notranslate nohighlight">\(\tilde{x}\)</span> to the feasible region of the relaxation.
If a point <span class="math notranslate nohighlight">\(\bar{x}\)</span> is feasible to the original MIP, we stop the computation and have found an integer feasible solution.</p>
<p>This computation sequence is expressed by the following pseudo-algorithmic schema.</p>
<img alt="../_images/pseudo_algorithm_fs.png" src="../_images/pseudo_algorithm_fs.png" />
<p>Obviously a big difficulty of the <strong>Feasibility Pump</strong> is the chance of entering cylces, when reaching the same <span class="math notranslate nohighlight">\(\tilde{x}\)</span>
twice. This means that the algorithm gets stuck and will never acquire a feasible solution. The easiest way to deal with this problem
is to perturb some of the integer variables in cases a cylce is detected.
The implementation in the <a class="reference internal" href="../_autosummary/hips.heuristics.FeasibilityPump.html#hips.heuristics.FeasibilityPump" title="hips.heuristics.FeasibilityPump"><code class="xref py py-class docutils literal notranslate"><span class="pre">FeasibilityPump</span></code></a> maintains two types
of cylce detection. The perturbation actions follow the rules described by Fischetti et al. <span id="id3">[<a class="reference internal" href="../references.html#id4" title="Matteo Fischetti, Fred Glover, and Andrea Lodi. The feasibility pump. Mathematical Programming, 104(1):91-104, Sep 2005. URL: https://doi.org/10.1007/s10107-004-0570-3, doi:10.1007/s10107-004-0570-3.">FGL05</a>]</span>.</p>
<p>In case we reach a cycle of length 1 (i.e. <span class="math notranslate nohighlight">\(\tilde{x}^{(i)}\)</span> = <span class="math notranslate nohighlight">\(\tilde{x}^{(i+1)}\)</span>) in the algorithm, the
<span class="math notranslate nohighlight">\(T\)</span> binary variables of the current integer solution <span class="math notranslate nohighlight">\(\tilde{x}\)</span> with highest distance <span class="math notranslate nohighlight">\(|{x\text{*}}_j - \tilde{x}_j|\)</span> are flipped for the calculation of the next
<span class="math notranslate nohighlight">\(\bar{x}\)</span>. The number <span class="math notranslate nohighlight">\(T\)</span> of variables to flip is uniformly chosen from the range <span class="math notranslate nohighlight">\(( \lfloor \frac{t}{2} \rfloor , \lfloor 1.5t \rfloor )\)</span>.
The parameter <span class="math notranslate nohighlight">\(t\)</span> can be specified when initializing the <strong>Feasibility Pump</strong>. By default <span class="math notranslate nohighlight">\(t\)</span> will be assigned with <span class="math notranslate nohighlight">\(\lceil \frac{n}{2} \rceil\)</span>,
with <span class="math notranslate nohighlight">\(n\)</span> the number of binary variables in the model.</p>
<p>In case a cycle of length <span class="math notranslate nohighlight">\(1 &lt; l \le 3\)</span> is detected, we uniformly choose a value <span class="math notranslate nohighlight">\({\rho}_j \in [-0.3, 0.7]\)</span> for
each binary variable <span class="math notranslate nohighlight">\(x_j\)</span> with <span class="math notranslate nohighlight">\(j \in I\)</span>. We then decide for each of those variables to flip the corresponding <span class="math notranslate nohighlight">\(\tilde{x}_j\)</span>
if <span class="math notranslate nohighlight">\(|{x\text{*}}_j - \tilde{x}_j| + max(0, {\rho}_j) &gt; 0.5\)</span>.</p>
<p>To find a high quality solution, the implementation offers the possibility to add a constraint
that ensures that the original objective function is still considered. In the case of a minimization problem a
constraint <span class="math notranslate nohighlight">\(c^\top x \leq \alpha \cdot c^\top \bar x^{(0)} + (1-\alpha) \cdot c^\top \bar x\)</span> is introduced, where <span class="math notranslate nohighlight">\(\bar x\)</span>
corresponds to the current LP feasible solution. Note that in the case of maximization, we have <span class="math notranslate nohighlight">\(\geq\)</span> instead of <span class="math notranslate nohighlight">\(\leq\)</span>.
The parameter <span class="math notranslate nohighlight">\(\alpha\)</span> can be set on initialization of the <strong>Feasibility Pump</strong> as a value between 0 and 1,
corresponding to how much we take the original objective function into consideration. The higher the <span class="math notranslate nohighlight">\(\alpha\)</span>, the more we optimize towards the original objective.</p>
<div class="section" id="example-1">
<h2>Example 1<a class="headerlink" href="#example-1" title="Permalink to this headline">¶</a></h2>
<a href="https://colab.research.google.com/github/cxlvinchau/hips-examples/blob/main/notebooks/feasibility_pump_10_teams_example.ipynb" target="_blank">
    <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/>
</a><p>In the example below, we consider the <a class="reference external" href="https://miplib.zib.de/instance_details_10teams.html">10 teams</a> problem from MIPLIB 2017 <span id="id4">[<a class="reference internal" href="../references.html#id10" title="Ambros Gleixner, Gregor Hendel, Gerald Gamrath, Tobias Achterberg, Michael Bastubbe, Timo Berthold, Philipp M. Christophel, Kati Jarck, Thorsten Koch, Jeff Linderoth, Marco Lübbecke, Hans D. Mittelmann, Derya Ozyurt, Ted K. Ralphs, Domenico Salvagnin, and Yuji Shinano. MIPLIB 2017: Data-Driven Compilation of the 6th Mixed-Integer Programming Library. Mathematical Programming Computation, 2021. URL: https://doi.org/10.1007/s12532-020-00194-3, doi:10.1007/s12532-020-00194-3.">GHG+21</a>]</span>.
A more detailed version of the example can be found on Google Colab.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hips</span> <span class="kn">import</span> <span class="n">load_problem</span>
<span class="kn">from</span> <span class="nn">hips.heuristics._feasibility_pump</span> <span class="kn">import</span> <span class="n">FeasibilityPump</span>

<span class="c1"># Load the model</span>
<span class="n">mip_model</span> <span class="o">=</span> <span class="n">load_problem</span><span class="p">(</span><span class="s2">&quot;10teams&quot;</span><span class="p">)</span>
<span class="c1"># Create the Feasibility Pump</span>
<span class="n">heur</span> <span class="o">=</span> <span class="n">FeasibilityPump</span><span class="p">(</span><span class="n">mip_model</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">heur</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="c1"># Inspect the solution</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Status: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">heur</span><span class="o">.</span><span class="n">get_status</span><span class="p">()))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Found solution: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">heur</span><span class="o">.</span><span class="n">get_objective_value</span><span class="p">()))</span>
<span class="n">heur</span><span class="o">.</span><span class="n">tracker</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;feasibility objective&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The figure below depicts the feasibility objective during a single run of the feasibility pump. Recall that the objective
in the feasibility pump corresponds to the L1 distance between the LP solution and the rounded solution.</p>
<img alt="../_images/fp-objective-10teams.png" src="../_images/fp-objective-10teams.png" />
<p>Observe that the objective value decreases and suddenly increases after the 400th iteration. This indicates that the feasibility
pump got stuck and perturbed the values to resolve the cycle. Consequently, the objective value is suddenly increased.</p>
</div>
<div class="section" id="example-2">
<h2>Example 2<a class="headerlink" href="#example-2" title="Permalink to this headline">¶</a></h2>
<a href="https://colab.research.google.com/github/cxlvinchau/hips-examples/blob/main/notebooks/feasibility_pump_22433_example.ipynb" target="_blank">
    <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/>
</a><p>Now we consider another problem, namely the <a class="reference external" href="https://miplib.zib.de/instance_details_22433.html">22433</a> problem from MIPLIB 2017 <span id="id6">[<a class="reference internal" href="../references.html#id10" title="Ambros Gleixner, Gregor Hendel, Gerald Gamrath, Tobias Achterberg, Michael Bastubbe, Timo Berthold, Philipp M. Christophel, Kati Jarck, Thorsten Koch, Jeff Linderoth, Marco Lübbecke, Hans D. Mittelmann, Derya Ozyurt, Ted K. Ralphs, Domenico Salvagnin, and Yuji Shinano. MIPLIB 2017: Data-Driven Compilation of the 6th Mixed-Integer Programming Library. Mathematical Programming Computation, 2021. URL: https://doi.org/10.1007/s12532-020-00194-3, doi:10.1007/s12532-020-00194-3.">GHG+21</a>]</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hips</span> <span class="kn">import</span> <span class="n">load_problem</span>
<span class="kn">from</span> <span class="nn">hips.heuristics._feasibility_pump</span> <span class="kn">import</span> <span class="n">FeasibilityPump</span>

<span class="c1"># Load the model</span>
<span class="n">mip_model</span> <span class="o">=</span> <span class="n">load_problem</span><span class="p">(</span><span class="s2">&quot;22433&quot;</span><span class="p">)</span>
<span class="c1"># Create the Feasibility Pump</span>
<span class="n">heur</span> <span class="o">=</span> <span class="n">FeasibilityPump</span><span class="p">(</span><span class="n">mip_model</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">heur</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="c1"># Inspect the solution</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Status: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">heur</span><span class="o">.</span><span class="n">get_status</span><span class="p">()))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Found solution: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">heur</span><span class="o">.</span><span class="n">get_objective_value</span><span class="p">()))</span>
<span class="n">heur</span><span class="o">.</span><span class="n">tracker</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;feasibility objective&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/fp-objective-22433.png" src="../_images/fp-objective-22433.png" />
<p>In this example a solution is found much quicker. It can be seen that the fluctuations are not as strong as in the previous
example.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="2stage_fp.html" class="btn btn-neutral float-right" title="Two Stage Feasibility Pump" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="abstract_diving.html" class="btn btn-neutral float-left" title="Diving Heuristics" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Severin Bals and Calvin Chau.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
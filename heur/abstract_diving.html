

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Diving Heuristics &mdash; HIPS 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/toggleprompt.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Feasibility Pump" href="feasibility_pump.html" />
    <link rel="prev" title="RENS" href="rens.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> HIPS
          

          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation and Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../heuristics.html">Heuristics</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="simple_rounding.html">Simple Rounding</a></li>
<li class="toctree-l2"><a class="reference internal" href="bounds.html">Bounds Heuristic</a></li>
<li class="toctree-l2"><a class="reference internal" href="rens.html">RENS</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Diving Heuristics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fractional-diving">Fractional diving</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#line-search-diving">Line Search Diving</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id3">Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="feasibility_pump.html">Feasibility Pump</a></li>
<li class="toctree-l2"><a class="reference internal" href="2stage_fp.html">Two Stage Feasibility Pump</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_api.html">Developer API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">HIPS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../heuristics.html">Heuristics</a> &raquo;</li>
        
      <li>Diving Heuristics</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/heur/abstract_diving.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="diving-heuristics">
<h1>Diving Heuristics<a class="headerlink" href="#diving-heuristics" title="Permalink to this headline">¶</a></h1>
<p>The following heuristics are so called <strong>Diving Heuristics</strong>. The general idea of <strong>Diving Heuristics</strong> is to quickly
depth-first traverse the <em>branch&amp;bound</em> tree to reach one of its leave nodes. This quick traversal down the tree leads to
the term <strong>diving</strong>. At each node of the tree the heuristic decides on which variable to branch, based on some promising
intuition. The specific branching condition depends on the type of heuristic.</p>
<p>A <strong>Diving Heuristic</strong> will stop in two cases:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>The current LP relaxation is infeasible</p></li>
<li><p>The iteration limit is reached</p></li>
</ol>
</div></blockquote>
<p>In the first case, the LP relaxation is infeasible. In this case,
the heuristic will be aborted and no MIP solution was found. The second case occurs if the heuristic exceeds a predetermined
iteration limit. In this case, the heuristic will yield the best found MIP solution, if any were found.</p>
<blockquote>
<div><ol class="arabic simple" start="3">
<li><p>The current LP relaxation solution is worse than the incumbent solution</p></li>
</ol>
</div></blockquote>
<p>A third case can be constructed by providing an initial MIP solution to the run of the heuristic. In case the solution
of the current LP relaxation is worse than this incumbent MIP solution, the heuristic will abort, as any further branching
can only lead to worse solutions.</p>
<p><strong>Diving Heuristics</strong> can be useful in many different scenarios. Since these heuristics do not require an MIP solver nor an
incumbent MIP solution, they can be used to find an initial solution for other heuristics. Furthermore, in many cases we do
not search for the best solution to the MIP, but rather only a feasible solution.
Furthermore, diving heuristics can be used in combination with a full <em>branch&amp;bound</em> run, to quickly find feasible solutions
to the MIP. This means that the bounding can be done early, thereby ignoring larger portions of the tree and leading to a major decrease in run time.</p>
<p>Unfortunately <strong>Diving Heuristics</strong> do not always find a feasible solution. Since the size of the <em>branch&amp;bound</em> tree exponentially
increases in the number of variables, the chance of success of a <strong>Diving Heuristic</strong> is proportionally small. Nevertheless,
the low computational cost of these heuristics encourages their application in practice.</p>
<div class="section" id="fractional-diving">
<h2>Fractional diving<a class="headerlink" href="#fractional-diving" title="Permalink to this headline">¶</a></h2>
<p>Fractional diving is a diving heuristic, that bounds the integer variable with lowest fractionality to the nearest
integer in each dive. The idea is based on page 17 of <span id="id1">[<a class="reference internal" href="../references.html#id2" title="Timo Berthold. Primal heuristics for mixed integer programs. Master's thesis, Technische Universität Berlin, 2006. URL: https://opus4.kobv.de/opus4-zib/files/1029/Berthold_Primal_Heuristics_For_Mixed_Integer_Programs.pdf.">Ber06</a>]</span>. It can be used to find a quick initial solution
or an efficient direction of branching in the branch and bound. In HIPS the heuristic is implemented in the <a class="reference internal" href="../_autosummary/hips.heuristics.FractionalDiving.html#hips.heuristics.FractionalDiving" title="hips.heuristics.FractionalDiving"><code class="xref py py-class docutils literal notranslate"><span class="pre">hips.heuristics.FractionalDiving</span></code></a> class.</p>
<p>The heuristic traverses one path of the branch and bound tree of the MIP model to the leaf node. At each branch of the tree,
the variable <span class="math notranslate nohighlight">\(x_j\)</span> with the lowest fractionality <span class="math notranslate nohighlight">\(f(x_j)\)</span> with respect to the current relaxation solution is bounded
to the closest integer value <span class="math notranslate nohighlight">\([x_j]\)</span>. This is done as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\textbf{if} \quad x_j - \lfloor x_j \rfloor \le \lceil x_j \rceil - x_j\\
\textbf{then} \quad upper\_bound(x_j) \leftarrow \lfloor x_j \rfloor\\
\textbf{else} \quad lower\_bound(x_j) \leftarrow \lceil x_j \rceil\end{split}\]</div>
<p>The traversal is discontinued if any relaxation is infeasible or a feasible integer solution is found.</p>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<a href="https://colab.research.google.com/github/cxlvinchau/hips-examples/blob/main/notebooks/fractional_diving_example.ipynb" target="_blank">
    <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/>
</a><p>In this example we consider a simple mixed-integer program. The example can also be found on Google Colab.</p>
<p>First, we define a method that creates the model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hips</span> <span class="kn">import</span> <span class="n">HIPSArray</span><span class="p">,</span> <span class="n">VarTypes</span><span class="p">,</span> <span class="n">ProblemSense</span>
<span class="kn">from</span> <span class="nn">hips.models</span> <span class="kn">import</span> <span class="n">MIPModel</span>
<span class="kn">from</span> <span class="nn">hips.solver</span> <span class="kn">import</span> <span class="n">GurobiSolver</span>
<span class="kn">from</span> <span class="nn">hips.heuristics</span> <span class="kn">import</span> <span class="n">FractionalDiving</span>

<span class="k">def</span> <span class="nf">build_model</span><span class="p">(</span><span class="n">mip_model</span><span class="p">):</span>
    <span class="c1"># Create variables</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">mip_model</span><span class="o">.</span><span class="n">add_variable</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">VarTypes</span><span class="o">.</span><span class="n">INTEGER</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="c1"># Add constraints</span>
    <span class="n">mip_model</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="n">HIPSArray</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">mip_model</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="n">HIPSArray</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">7</span><span class="p">)</span>
    <span class="c1"># Set objective and problem sense</span>
    <span class="n">mip_model</span><span class="o">.</span><span class="n">set_objective</span><span class="p">(</span><span class="n">HIPSArray</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="n">mip_model</span><span class="o">.</span><span class="n">set_mip_sense</span><span class="p">(</span><span class="n">ProblemSense</span><span class="o">.</span><span class="n">MAX</span><span class="p">)</span>
</pre></div>
</div>
<p>Afterwards, we instantiate the model, apply the heuristic and output the found solution.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mip_model</span> <span class="o">=</span> <span class="n">MIPModel</span><span class="p">(</span><span class="n">GurobiSolver</span><span class="p">())</span>
<span class="n">build_model</span><span class="p">(</span><span class="n">mip_model</span><span class="p">)</span>

<span class="n">heur</span> <span class="o">=</span> <span class="n">FractionalDiving</span><span class="p">(</span><span class="n">mip_model</span><span class="p">)</span>
<span class="n">heur</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Status: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">heur</span><span class="o">.</span><span class="n">get_status</span><span class="p">()))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Found solution: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">heur</span><span class="o">.</span><span class="n">get_objective_value</span><span class="p">()))</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;With Variable values: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">({</span><span class="n">var</span><span class="p">:</span> <span class="n">heur</span><span class="o">.</span><span class="n">variable_solution</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">mip_model</span><span class="o">.</span><span class="n">get_variables</span><span class="p">()}))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="line-search-diving">
<h2>Line Search Diving<a class="headerlink" href="#line-search-diving" title="Permalink to this headline">¶</a></h2>
<p>Now we consider the <strong>Line Search Diving</strong> heuristic as presented by <span id="id2">[<a class="reference internal" href="../references.html#id7" title="Gregor Hendel. New rounding and propagation heuristics for mixed integer programming. 2011.">Hen11</a>]</span>. As the name suggests, this
heuristic follows the general structure of a diving heuristic, i.e. bounds are introduced or variables are fixed to
explore a branch of a branch and bound tree. In <a class="reference internal" href="../_autosummary/hips.heuristics.LineSearchDiving.html#hips.heuristics.LineSearchDiving" title="hips.heuristics.LineSearchDiving"><code class="xref py py-class docutils literal notranslate"><span class="pre">hips.heuristics.LineSearchDiving</span></code></a>, the selected variable in each step is fixed to a value.</p>
<p>The choice of the variable that is fixed is made as follows. Suppose <span class="math notranslate nohighlight">\(x^R\)</span> is the solution found at the root
node <span class="math notranslate nohighlight">\(R\)</span> in the branch and bound algorithm. Let <span class="math notranslate nohighlight">\(N\)</span> be an arbitrary node within the branch and bound tree
(i.e. not the root node) and <span class="math notranslate nohighlight">\(x^N\)</span> the corresponding solution. At <span class="math notranslate nohighlight">\(N\)</span> line search diving considers the line
between <span class="math notranslate nohighlight">\(x^N\)</span> and <span class="math notranslate nohighlight">\(x^R\)</span> and conceptually moves towards <span class="math notranslate nohighlight">\(x^R\)</span> and checks which variable becomes integer first.
This variable is then selected and fixed.</p>
<p>Since our heuristic does not operate within a branch and bound algorithm, the initial variables that are fixed/selected
are chosen randomly.</p>
<div class="section" id="id3">
<h3>Example<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<a href="https://colab.research.google.com/github/cxlvinchau/hips-examples/blob/main/notebooks/line_search_diving_example.ipynb" target="_blank">
    <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/>
</a><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hips</span> <span class="kn">import</span> <span class="n">load_problem</span>
<span class="kn">from</span> <span class="nn">hips.heuristics</span> <span class="kn">import</span> <span class="n">LineSearchDiving</span>

<span class="c1"># Load problem</span>
<span class="n">mip_model</span> <span class="o">=</span> <span class="n">load_problem</span><span class="p">(</span><span class="s2">&quot;osorio-cta&quot;</span><span class="p">)</span>

<span class="c1"># Instantiate diving heuristic</span>
<span class="n">diver</span> <span class="o">=</span> <span class="n">LineSearchDiving</span><span class="p">(</span><span class="n">mip_model</span><span class="p">)</span>
<span class="c1"># Deactivate trivial rounding</span>
<span class="n">diver</span><span class="o">.</span><span class="n">_round_trivially</span> <span class="o">=</span> <span class="k">lambda</span> <span class="p">:</span> <span class="bp">False</span>
<span class="c1"># Start computation</span>
<span class="n">diver</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>

<span class="c1"># Output solution</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Status: {diver.get_status()}&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Found solution: {diver.get_objective_value()}&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;With Variable values: { {var: diver.variable_solution(var) for var in mip_model.get_variables()} }&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="feasibility_pump.html" class="btn btn-neutral float-right" title="Feasibility Pump" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="rens.html" class="btn btn-neutral float-left" title="RENS" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Severin Bals and Calvin Chau.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>